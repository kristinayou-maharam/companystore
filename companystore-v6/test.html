<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Combined Slick Carousel and Book Information</title>
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.5.8/slick-theme.min.css'>
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.5.8/slick.css'>
  <style>
    .slick-carousel {
      margin: 0 auto;
      width: 350px;
    }

    .slick-slide {
      width: 350px;
    }

    .slick-next::before, .slick-prev::before {
      color: black;
      opacity: 0.5;
    }

    img {
      width: 350px;
    }
  </style>
</head>
<body>

<!-- Carousel Container -->
<div class="slick-carousel" id="image-carousel"></div>

<!-- Book Information Container -->
<div id="product-info"></div>

<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/jquery.slick/1.5.7/slick.min.js"></script>

<script>
  // Fetch JSON data from new.json
  fetch("./src/new.json")
    .then(response => response.json())
    .then(data => {
      // Extract images from the first item in the JSON data
      const firstItemImages = Array.isArray(data.new[0].image) ? data.new[0].image : [data.new[0].image];

      // Call the function to create the carousel with the first item's images
      createCarousel(firstItemImages);

      // Function to display books information
      window.displayNew = function (index) {
        const neww = data.new[index];
        const dropdownOptions = neww.options.map(option => `<option value="${option.value}">${option.variation}</option>`).join('');
        const newInfoHTML = `
          <img src="${neww.image}" alt="${neww.name}" id="detailproductimg">
          <div id ="detaildescription">
            <h2>${neww.name}</h2>
            <p>${neww.description}</p>
            <p>Price: $${neww.price.toFixed(2)}</p>
            <label for="variationDropdown"><p>Variation:</p></label>
            <select id="variationDropdown">${dropdownOptions}</select>
            <p>Quantity per Order: ${neww.quantity}</p>
            <p id="don">DON: </p><p id="selectedValue">Selected Value</p>
            <p id="note">${neww.Note}</p>
          </div>
        `;
        // Display books information
        document.getElementById("product-info").innerHTML = newInfoHTML;

        const variationDropdown = document.getElementById('variationDropdown');
        const selectedValueElement = document.getElementById('selectedValue');

        variationDropdown.addEventListener('change', function () {
          const selectedOptionLabel = variationDropdown.value.trim();  // Trim leading/trailing spaces

          console.log('Selected Option Label:', selectedOptionLabel);

          if (selectedOptionLabel !== "SelectNone") {
            const selectedOption = neww.options.find(option => option.variation.trim() === selectedOptionLabel);

            console.log('Selected Option:', selectedOption);

            if (selectedOption) {
              const correspondingValue = selectedOption.value;
              selectedValueElement.textContent = `${selectedOptionLabel}`;
            } else {
              selectedValueElement.textContent = 'Unknown Value';
            }
          } else {
            selectedValueElement.textContent = 'Please select an option';
          }
        });
      };
    })
    .catch(error => console.error('Error fetching JSON:', error));

  // Function to create the carousel HTML
  function createCarousel(images) {
    const carouselElement = document.getElementById('image-carousel');

    images.forEach(imageUrl => {
      const slideElement = document.createElement('div');
      slideElement.innerHTML = `<img src="${imageUrl}" alt="Slide Image">`;
      carouselElement.appendChild(slideElement);
    });

    $('.slick-carousel').slick({
      infinite: true,
      slidesToShow: 1,
      slidesToScroll: 1,
      arrows: false,
      dots: true
    });
  }
</script>

</body>
</html>
